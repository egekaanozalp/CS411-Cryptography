import RSA_Oracle_client as rsoc

# Step 1: We need to get C, N and e values from the server:
# c, n, e = rsoc.RSA_Oracle_Get()
c = 4970588410618684520616769777087491144540786951689424245402876626495743374781751403055244264807452811982080827774809116329570646626650089415989625985195382345756791379040942972448647260804401976140915490077534904793744539218120735676687229805163236359486929570288496228634431204890355618701453598386055547284026979306061551478674033661283559056482815427073542180699991714823601633143410848746507556919257847127789379293265206857245626727083488818651813072949776704633128868818170744467860137743287167769758656506344239292660106423640203085405410451663921765943910891070890422286487391181480502398937005016878844119790
n = 16939269462313198277725089002524968140769895904731797247921693446825361577176513265093962001473249149493514478809355121972226854971742591412020947781343582572258409348854687792672350790838706795045105779549770778632847428289027972956461589642862664604406205649788062899700494060455208957227204718515101331592572887762868780071870612248382350488623041960895952847347193036811161635348404536654480418700288618890111185617389009319953809419282210422869145631879305871459779170673590029863798266603861263916454445940018625253525716638055179599474296505004768081393212277916373461197482274715508530005125354616487101316387
e = 65537

# Step 2: Choose an arbitrary integer value (I selected 5) as r and raise it to the power e:
r = 5
r_power_e = pow(r, e, n)

# Step 3: Multiply this value with c. Then query the cipher:
decrypted_message = rsoc.RSA_Oracle_Query((c*r_power_e)%n)

# Step 4: Divide the decrypted message by r:
decrypted_message = decrypted_message // r

# Final Step: Decode the decrypted message to see the actual one as string.
message = decrypted_message.to_bytes((decrypted_message.bit_length() + 7)//8, byteorder = "big").decode("utf-8")
print()
print("The message is:", message)
print()

# Check the answer "Bravo! You found it. Your secret code is 55301":
rsoc.RSA_Oracle_Checker(message)
print()