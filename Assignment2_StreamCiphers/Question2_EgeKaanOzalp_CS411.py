import myntl
import sympy
import client

'''
# Receive the e and c values from the server:
e, c = client.getQ2()
print(e)
print("---------------------------------------")
print(c)
'''

# Assign these values to e and c and start solving the question:
e = 21626761477990168577093136042211331104057476527595543957535521420290690776347149562932475771250243596218000309975557772150288539599275202373022740702374389893292653550010871724486770667116132629732264908009041574577754050807753448879948809503307713809837384029505669188559896873747262543071877093822335271076343637715725408793192173506019152335186401684370573737382073159408836616281315721804428042610976577900189318512355541171527071227921853949754795810887227367241772000785178147542284421584640938664434488698114671340786258046151686510054311226261363609598210649356954948007626483984334019704203599096675076138167
c = 14821578852530657606299719563206993410607805151960003650679673651547380500840379715593585870810892375855951666257559439701352662090744739809374658508955485162251493802413352301894012758254232678076792900208047525706402831501925510404620195596505529899717638263236732804749107952439134151390943060257606918394937754441971377952776434091828254357770860558101771585647494584201049515799778211509244049979495726751366878546498155029995602866455405001296741561310023674946406540128632791585590497490328131406156263902886012585974625535602107988574546111910963059807119717455041500438985654535394808848666189252921678312385
p = 163812632438116402334651955238877888051471698595800699322979615035703105353498598900017754479082745390305183480326386193928762023006697325502630355995540302095536983747674239699082775937971908945314983176639634719523082664655125286220339981282043117576435108592265744474672826334454420325847233209118053745479
q = 167991311406281829893277907517380926743297770437237817698088843729837413680407121035993724942424328049100226903066919418963576739130754375674323262394889417412537943169688299724092631996519692955388293697048331540030669504591419100438660952486903606581569836090930608369486871356825028654569386086674053846173

n = p*q

if sympy.isprime(p) and sympy.isprime(q):
    print("Since p and q are both prime:")
    print("1: The phi value of the numbers are themselves minus 1.")
    print("2: They are coprime, so phi(n) = phi(p*q) = phi(p)*phi(q) = (p-1)*(q-1)")
    phi_n = (p-1)*(q-1)
    print("Phi(n) =", phi_n)

d = myntl.modinv(e, phi_n)
print("d =", d)

m = pow(c, d, n)

print("The answer is m =", m)

# Decode the answer and send it to the server:
message = m.to_bytes((m.bit_length()+7) // 8, byteorder="big").decode("utf-8")
print("Message:", message)
client.checkQ2(message)